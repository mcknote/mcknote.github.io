<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-tw">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="description" content= "This is where I started. Get inspired by the guides and stories from McK & Note and take the initiative to figure out solutions for life." />
<meta property="article:author" content="https://www.facebook.com/mcknote" />
<meta property="fb:pages" content="526667947506539" />


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="MSBA,Cal Poly,Data Science,Econometrics," />





  <link rel="alternate" href="/atom.xml" title="McK & Note" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />




  <meta property="fb:admins" content="kiminire" />
  <meta property="fb:app_id" content="537807449725839" />



<meta name="description" content="找完工作以後，日子依舊忙碌。這個學期 MSBA 有三門課，分別代表 Business Analytics 中三個滿重要的發展方向：分析理論、程式設計、和資料庫。這篇先從偏理論的計量經濟學談起。">
<meta name="keywords" content="MSBA,Cal Poly,Data Science,Econometrics">
<meta property="og:type" content="article">
<meta property="og:title" content="＃／Advanced Econometrics I">
<meta property="og:url" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/index.html">
<meta property="og:site_name" content="McK &amp; Note">
<meta property="og:description" content="找完工作以後，日子依舊忙碌。這個學期 MSBA 有三門課，分別代表 Business Analytics 中三個滿重要的發展方向：分析理論、程式設計、和資料庫。這篇先從偏理論的計量經濟學談起。">
<meta property="og:image" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/cover.jpg">
<meta property="og:image" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/takayama.jpg">
<meta property="og:image" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/seisaku.jpg">
<meta property="og:image" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/shinjuku.jpg">
<meta property="og:updated_time" content="2017-05-07T09:28:43.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="＃／Advanced Econometrics I">
<meta name="twitter:description" content="找完工作以後，日子依舊忙碌。這個學期 MSBA 有三門課，分別代表 Business Analytics 中三個滿重要的發展方向：分析理論、程式設計、和資料庫。這篇先從偏理論的計量經濟學談起。">
<meta name="twitter:image" content="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/cover.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post"},
    fancybox: false,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '作者'
    },
    algolia: {
      applicationID: 'K2YQUUH3TO',
      apiKey: 'abbed1615cd059b39d06a38037971aeb',
      indexName: 'mcknote',
      hits: {"per_page":10},
      labels: {"input_placeholder":"搜尋主題、內容、資源⋯⋯","hits_empty":"找不到包含關鍵字「${query}」的文章","hits_stats":"找到了 ${hits} 篇相關文章（搜尋時間：${time} 毫秒）"}
    }
  };
</script>



  <link rel="canonical" href="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/"/>





  <title> ＃／Advanced Econometrics I | McK & Note </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-tw">

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=176081199193364";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '537807449725839',
      xfbml      : true,
      version    : 'v2.6'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/zh_tw/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-75181285-1', 'auto');
  ga('send', 'pageview');
</script>




  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=55480462";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  
    <div class="site-meta-headline">
      <a>
        <img class="custom-logo-image" src="/images/logo.png"
             alt="McK & Note"/>
      </a>
    </div>
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">McK & Note</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分類
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            文庫
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            標籤
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            搜尋
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://www.mcknote.com/2016/12/26/Advanced-Econometrics-I/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jimmy Lin">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/default_avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="McK & Note">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="McK & Note" src="/images/logo.png">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                ＃／Advanced Econometrics I
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">發表於</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-26T07:30:00-08:00">
              2016-12-26
            </time>

          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/＃/" itemprop="url" rel="index">
                    <span itemprop="name">＃</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/26/Advanced-Econometrics-I/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/26/Advanced-Econometrics-I/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
            &nbsp; | &nbsp;
            <div class="fb-like" data-layout="button_count" data-share="true"></div>
          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="/2016/12/26/Advanced-Econometrics-I/cover.jpg" alt="Cover"></p>
<p>找完工作以後，日子依舊忙碌。這個學期 MSBA 有三門課，分別代表 Business Analytics 中三個滿重要的發展方向：分析理論、程式設計、和資料庫。這篇先從偏理論的計量經濟學談起。</p>
<a id="more"></a>
<h2 id="秋季學期的安排"><a href="#秋季學期的安排" class="headerlink" title="秋季學期的安排"></a>秋季學期的安排</h2><p>與之前上 <em><a href="/2016/09/03/Data-Visualization-Storytelling/" title="Data Visualization">Data Visualization</a></em> 和 <em><a href="/2016/09/25/Quantitative-Methods-II/" title="Statistics">Statistics</a></em> 的夏季學期不同，秋季學期有整整十週（加期末考一週），所以排課就變得滿正常，不過當然也滿考驗時間安排，畢竟不能像夏季學期，可以把全部時間花在單一科目上。這學期 MSBA 學生要修的課有三門：</p>
<ul>
<li><em>Advanced Econometrics I</em>（理論、分析）</li>
<li><em><a href="/2017/01/21/Computational-Methods/" title="Computational Methods">Computational Methods</a></em>（實作）</li>
<li><em><a href="/2017/02/17/Data-Management/" title="Data Management">Data Management</a></em>（資料庫操作、管理）</li>
</ul>
<p>　<br>雖然每門課看起來都滿難的（Computational？Advanced？！），但其實<del>也真的滿難</del>認真修完一遍以後，真的能體會到學好這三門課是在 Business Analytics 或 Data Science 領域必備的基礎；而且如果有心繼續鑽研，會發現業界前沿的技術和應用，都和這三個發展方向脫離不了關係，所以不管是入門或進階、研究或應用，似乎都得從這三門課開始。</p>
<p>以 <em>Advanced Econometrics</em> 這門課為例，雖然一開始會被各式各樣的公式、證明佐矩陣運算，外加數十頁的作業搞得有點暈頭轉向，但只要跨過計算的門檻後，回頭一看，就比較能理解線性迴歸模型（LRM）中各項假設和定理的關係，也才清楚如何正確計算、解讀各項統計數據。所以儘管讀者可能跟我一樣，曾經感覺自己踏入 Data Science，就是比較想走應用，對理論則敬而遠之；但要能正確使用工具與解讀結果，仍需要紮實的理論知識，這就是 <em>Advanced Economics</em> 的教學目的。以下我想盡量簡單介紹我們學了些什麼。</p>
<blockquote>
<p>請注意：本文公式較多，建議用電腦閱讀；如果無法正常顯示，請試用其它瀏覽器，或<a href="Advanced-Econometrics-I.pdf">下載全文</a>（3.6 MB）。</p>
</blockquote>
<h2 id="老師和教學方法"><a href="#老師和教學方法" class="headerlink" title="老師和教學方法"></a>老師和教學方法</h2><p>這門課的老師是 Dr. Jonathan James，他是個熱情洋溢，也很關心學生的好教授，而且平均一門課會講三四個很棒的笑話，活潑的風格常讓我聯想 BoJack Horseman 裡的 Mr. Peanutbutter。教學方法是版書和投影片，作業形式包括手寫證明題，還有用 R 實作數據分析、並解讀結果。順帶一提，Dr. James 的所有文件都是用 <a href="https://zh.wikipedia.org/wiki/LaTeX" target="_blank" rel="external">LaTeX</a> 編排，其精美程度讓我忍不住也跳入學習 LaTeX 的深淵了……。</p>
<p>由於 Dr. James 已經把上課內容都寫進講義裡了，我們整堂課下來也沒用到教科書，不過在 Syllabus 上他指定的教科書是 William H. Greene 的 <a href="https://www.amazon.com/Econometric-Analysis-7th-William-Greene/dp/0131395386" target="_blank" rel="external"><em>Econometric Analysis</em></a>。但因為這本書讀起來實在有點生硬（可能是我個人閱讀能力問題），我在朋友推薦下，找了一本 Jeffrey M. Wooldridge 的 <a href="https://www.amazon.com/Introductory-Econometrics-Modern-Approach-Economics/dp/130527010X" target="_blank" rel="external"><em>Introductory Econometrics: A Modern Approach</em></a>。後者的優點包括：</p>
<ul>
<li><strong>清晰的架構，深入淺出</strong>：在 Simple Regression Model 中就介紹了許多數值和性質，接下來的 Multiple Regression Model 再談 Asymptotics 等等</li>
<li><strong>貼心的附錄，照顧數學弱勢</strong>：包括 Linear Function、Matrix、Probability、Statistics 等基本概念，記憶模糊時（which is always）可以快速回顧</li>
</ul>
<p><em>Introductory Econometrics</em> 成功救了我好幾次作業和考試，也是我心目中 Econometrics 領域最棒的教科書之一。</p>
<h2 id="課前準備"><a href="#課前準備" class="headerlink" title="課前準備"></a>課前準備</h2><p>當然，從附錄的內容可以看出要學好 Econometrics 需要一點線性代數（linear algebra）和統計（statistics）基礎。粗淺一點來說，需要具備的能力如下：</p>
<ul>
<li><strong>矩陣</strong>：會讀矩陣表達式，熟練加減乘除、轉置、逆矩陣等運算</li>
<li><strong>統計</strong>：熟練平均、方差（變異數）、標準差等運算，以及母體和樣本的關係</li>
<li><strong>機率</strong>：瞭解條件機率、CDF、PMF／PDF 的意義</li>
</ul>
<p>以上這些算是最低要求，實際開始學以後，還會碰到許多衍生的觀念、證明和公式，入門先具備清晰的基本觀念就好。有任何不清楚的觀念，可以參考 <em><a href="/2016/09/25/Quantitative-Methods-II/" title="Statistics">Statistics</a></em> 中提到的相關資源。既然都學到 Econometrics 了，一定要捨得花時間把所有觀念弄懂，畢竟這會直接影響日後的分析能力。例如，如果不熟矩陣運算，就沒辦法很有效率地思考線性迴歸（<a href="https://zh.wikipedia.org/wiki/%E7%B7%9A%E6%80%A7%E5%9B%9E%E6%AD%B8" target="_blank" rel="external">Linear Regression</a>）中參數的性質，也就很難理解什麼情況下參數會出現偏誤（bias），以及怎樣避免偏誤。如前所述，要能正確使用各類統計工具，必須先瞭解這些工具背後的理論。</p>
<h2 id="線性迴歸"><a href="#線性迴歸" class="headerlink" title="線性迴歸"></a>線性迴歸</h2><p>如果上面的運算都沒什麼問題（或是感覺沒什麼問題想先繼續往下讀），就可以來認識 <em>Advanced Economics</em> 中主角中的主角——線性迴歸模型（linear regression model，LRM）了：</p>
<script type="math/tex; mode=display">
y_{i}=\beta _{0}+\beta _{1} x_{1}+\beta _{2} x_{2}+\ldots+\beta _{k} x_{k}+\varepsilon _{i} \tag{1}</script><p>公式中的 <script type="math/tex">i</script> 表示第 <script type="math/tex">i</script> 個樣本（sample observation）；<script type="math/tex">y</script> 為因變量（dependent variable），即模型打算解釋的反應變量（response）；<script type="math/tex">x</script> 為自變量（independent variable），即模型中用來解釋 <script type="math/tex">y</script> 的控制變量（control）。<script type="math/tex">y</script> 和 <script type="math/tex">x</script> 的其它名稱可以參考以下 <em>Introductory Econometrics</em> 的整理：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">Y 的名稱</th>
<th style="text-align:left">X 的名稱</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Dependent variable</td>
<td style="text-align:left">Independent variable</td>
</tr>
<tr>
<td style="text-align:left">Explained variable</td>
<td style="text-align:left">Explanatory variable</td>
</tr>
<tr>
<td style="text-align:left">Response variable</td>
<td style="text-align:left">Control variable</td>
</tr>
<tr>
<td style="text-align:left">Predicted variable</td>
<td style="text-align:left">Predictor variable</td>
</tr>
<tr>
<td style="text-align:left">Regressand</td>
<td style="text-align:left">Regressor</td>
</tr>
</tbody>
</table>
</div>
<p>另外，公式中的 <script type="math/tex">\beta</script> 為參數（parameter or estimate），表示不同 <script type="math/tex">x</script> 對 <script type="math/tex">y</script> 的影響，其中 <script type="math/tex">\beta_{0}</script> 為用來調整大小的截距項（intercept）；最後，<script type="math/tex">\varepsilon</script> 是 <script type="math/tex">y</script> 中無法以 <script type="math/tex">x</script> 解釋的殘差項（residual）。如果用一句話簡單說明 <script type="math/tex">y</script>、<script type="math/tex">x</script>、<script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script>，即<strong>試著用 <script type="math/tex">\beta</script> 組合 <script type="math/tex">x</script> ，得出最接近 <script type="math/tex">y</script>、即 <script type="math/tex">\varepsilon</script> 最小的預估值</strong>。在這裡，<strong>線性</strong>（linear）的意義在於組合的方式為<strong>線性組合</strong>（linear combination），即 <script type="math/tex">\beta</script> 是線性的，不會出現 <script type="math/tex">\beta _{1} x_{1}+\beta _{1}^{2} x_{2}</script> 之類的情況。</p>
<p>由此可見，LRM 是試著用 <script type="math/tex">x</script> 基於 <script type="math/tex">\beta</script> 的線性組合來預測（或說描述）<script type="math/tex">y</script>。為了和實際的反應變量 <script type="math/tex">y</script> 區別，<script type="math/tex">(\beta _{0}+\beta _{1} x_{1}+\beta _{2} x_{2}+\ldots+\beta _{k} x_{k})</script> 這部分又被稱為 <script type="math/tex">\hat{y}</script>（讀作 <em>Y-hat</em>，可稱作 fitted value），所以上述 <script type="math/tex">(1)</script> 式可以表示為：</p>
<script type="math/tex; mode=display">
y_{i}=\hat{y}_{i}+\varepsilon _{i} \tag{2}</script><p>　<br>可以理解為「觀測值＝預估值＋雜訊」。到這裡，我已經用第 <script type="math/tex">i</script> 個樣本（一列）解釋完 LRM 的結構，如果用矩陣記錄 <script type="math/tex">n</script> 個樣本（多列）的運算，就可以推廣成下式：</p>
<script type="math/tex; mode=display">
Y = X\beta+\varepsilon \tag{3}</script><ul>
<li><script type="math/tex">Y</script> 是一個 <script type="math/tex">\left( n\times 1\right)</script> 的矩陣，因為有 <script type="math/tex">n</script> 個樣本</li>
<li><script type="math/tex">X</script> 是一個 <script type="math/tex">\left( n\times k\right)</script> 的矩陣，因為根據 <script type="math/tex">(1)</script> 式，在這 <script type="math/tex">n</script> 個樣本中我們用了 <script type="math/tex">k</script> 組自變量</li>
<li>最後，<script type="math/tex">\varepsilon</script> 是一個 <script type="math/tex">\left( n\times 1\right)</script> 的矩陣</li>
</ul>
<p>如果將 <script type="math/tex">Y</script>、<script type="math/tex">X</script> 和 <script type="math/tex">\varepsilon</script> 化為日常中常見的 Excel 表格，可以這樣表示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本編號</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（人流）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>180</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>170</td>
<td>1.5</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>200</td>
<td>1.3</td>
</tr>
</tbody>
</table>
</div>
<p>可以看到樣本有 <script type="math/tex">n</script> 個，自變量有 <script type="math/tex">k</script> 組。另外，請回想一下 <script type="math/tex">(1)</script> 式中 <script type="math/tex">\beta</script> 的表達形式，由於這個模型中有 <script type="math/tex">k</script> 組自變量，相應地應該要有 <script type="math/tex">k</script> 個 <script type="math/tex">\beta</script> 作為線性組合的比例，所以 <script type="math/tex">(3)</script> 式中的 <script type="math/tex">\beta</script> 是一個 <script type="math/tex">\left( k\times 1\right)</script> 的矩陣。</p>
<p>利用 <script type="math/tex">(3)</script> 式中的矩陣表達，可以很精簡地將上面表格中的數值，以 <script type="math/tex">Y</script>、<script type="math/tex">X</script>、<script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 來表示，它們之間的關係仍和單一樣本中的 <script type="math/tex">y</script>、<script type="math/tex">x</script>、<script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 一致：<strong>試著用 <script type="math/tex">\beta</script> 組合 <script type="math/tex">X</script> ，得出最接近 <script type="math/tex">Y</script>、即 <script type="math/tex">\varepsilon</script> 最小的預估值</strong>。</p>
<p><img src="/2016/12/26/Advanced-Econometrics-I/takayama.jpg" alt="高山"></p>
<h2 id="最小平方法"><a href="#最小平方法" class="headerlink" title="最小平方法"></a>最小平方法</h2><p>介紹完 LRM 基本架構後的第一個問題，就是「如何算出 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> ？」關鍵在於前面提到的一句話：<strong>得出最接近 <script type="math/tex">Y</script>、即 <script type="math/tex">\varepsilon</script> 最小的預估值</strong>。從上面的公式可以得知 <script type="math/tex">\varepsilon</script> 的計算方法為：</p>
<script type="math/tex; mode=display">
\varepsilon = Y-\hat{Y} = Y - X\beta \tag{4}</script><p>　<br>考慮到 <script type="math/tex">\varepsilon</script> 是一個 <script type="math/tex">\left( n\times 1\right)</script> 的矩陣，最小值的目標自然是 <script type="math/tex">\sum _{i=1}^{n}\varepsilon _{i}</script>；不過，為了避免 <script type="math/tex">\varepsilon _{i}</script> 正負抵銷，我們實際要計算的是 <script type="math/tex">\sum _{i=1}^{n}\varepsilon _{i}^{2}</script>。用矩陣來表示，就是 <script type="math/tex">\varepsilon '\varepsilon</script>，解釋如下：</p>
<script type="math/tex; mode=display">
\varepsilon' =\left[ \varepsilon _{1},\varepsilon _{2}\ldots ,\varepsilon _{n}\right],\quad
\varepsilon =\left[ \begin{matrix} \varepsilon _{1}\\ \varepsilon _{2}\\ \vdots \\ \varepsilon _{n}\end{matrix} \right],\quad
\varepsilon'\varepsilon = (\varepsilon _{1}^{2}+\varepsilon _{2}^{2}+\ldots +\varepsilon _{n}^{2}) = \sum _{i=1}^{n}\varepsilon _{i}^{2}</script><p>　<br>所以找到<strong>使 <script type="math/tex">\sum _{i=1}^{n}\varepsilon _{i}^{2}</script> 達到最小值的 <script type="math/tex">\beta</script> 的方法</strong>就是<a href="https://en.wikipedia.org/wiki/Ordinary_least_squares" target="_blank" rel="external">最小平方法</a>（ordinary least squares，OLS）。</p>
<h3 id="母體和樣本"><a href="#母體和樣本" class="headerlink" title="母體和樣本"></a>母體和樣本</h3><p>在談如何計算 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 前，我想先來小小澄清一下（？）母體和樣本的關係。雖然說我們想預測的是 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script>，但隨著資料的不同，所得到的 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 也會不同。比方說，在前面的表格中：</p>
<ul>
<li>用從第一個到第 <script type="math/tex">n</script> 個樣本所得到的 <script type="math/tex">\beta_{n}</script> 和 <script type="math/tex">\varepsilon_{n}</script></li>
<li>用從第一個到第 <script type="math/tex">(n/2)</script> 個樣本所得到的 <script type="math/tex">\beta_{n/2}</script> 和 <script type="math/tex">\varepsilon_{n/2}</script></li>
</ul>
<p>兩組數據可能會不一樣，而就算我們選擇採用 <script type="math/tex">\beta_{n}</script> 和 <script type="math/tex">\varepsilon_{n}</script>，在我們沒觀測到的地方可能還有：</p>
<ul>
<li>由從第一個到第 <script type="math/tex">2n</script> 個樣本所得到的 <script type="math/tex">\beta_{2n}</script> 和 <script type="math/tex">\varepsilon_{2n}</script></li>
</ul>
<p>這是因為我們觀察到的數值，幾乎永遠都是<strong>樣本</strong>（sample）而非象徵全貌的<strong>母體</strong>（population），所以統計值（<script type="math/tex">\beta_{n}</script>、<script type="math/tex">\varepsilon_{n}</script>、平均、方差等等）會不斷隨著資料改變而浮動。為了將這些<strong>浮動的數值</strong>和母體中<strong>固定的數值</strong>區分開來，我們會說母體中不變的參數和殘差是 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script>，而我們試著用樣本估計的參數和殘差是 <script type="math/tex">b</script> 和 <script type="math/tex">e</script>。<strong> <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 是不變的，而 <script type="math/tex">b</script> 和 <script type="math/tex">e</script> 會隨著樣本的變化而改變</strong>。類似的作法也涵蓋了平均和方差：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">統計值</th>
<th style="text-align:left">母體（不變）</th>
<th style="text-align:left">樣本（浮動）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">平均</td>
<td style="text-align:left"><script type="math/tex">\mu</script></td>
<td style="text-align:left"><script type="math/tex">\overline {x}</script></td>
</tr>
<tr>
<td style="text-align:left">方差</td>
<td style="text-align:left"><script type="math/tex">\sigma^{2}</script></td>
<td style="text-align:left"><script type="math/tex">s^{2}</script></td>
</tr>
<tr>
<td style="text-align:left">參數</td>
<td style="text-align:left"><script type="math/tex">\beta</script></td>
<td style="text-align:left"><script type="math/tex">b</script></td>
</tr>
<tr>
<td style="text-align:left">殘差</td>
<td style="text-align:left"><script type="math/tex">\varepsilon</script></td>
<td style="text-align:left"><script type="math/tex">e</script></td>
</tr>
</tbody>
</table>
</div>
<p>所以前面提到的 <script type="math/tex">(3)</script> 式可以再進一步如下表示：</p>
<script type="math/tex; mode=display">
Y = X\beta+\varepsilon = Xb + e \tag{5}</script><p>　<br>這邊 <script type="math/tex">b</script> 和 <script type="math/tex">e</script> 的矩陣維度，和 <script type="math/tex">\beta</script> 和 <script type="math/tex">\varepsilon</script> 是相同的。需要注意的是，雖然 <script type="math/tex">\varepsilon</script> 和 <script type="math/tex">e</script> 都是殘差（實際上兩者的稱呼會有所區別），但兩者的性質有著微妙的差異：</p>
<ul>
<li><script type="math/tex">\varepsilon</script> 是母體中的實際誤差</li>
<li><script type="math/tex">e</script> 除了實際誤差外，還包含了受限於樣本數的解釋誤差</li>
</ul>
<p>比方說，小明是個消費完全理性的人，他平常有記帳的習慣，但有時候記得太快，會按錯個位數，這個誤差就是 <script type="math/tex">\varepsilon</script>；小華根據小明的行為，分析他一半的帳目，發現其中有些無法解釋的零頭，這個誤差就是 <script type="math/tex">e</script>。由於樣本只佔母體的一半，<script type="math/tex">e</script> 除了包含小明確實按錯的誤差以外，也包含了樣本資訊不及母體資訊的誤差。這時，根據 <script type="math/tex">e</script> 所計算出的 <script type="math/tex">b</script> 就會和 <script type="math/tex">\beta</script> 不太一樣，就算拿這個模型去預測小明另一半的帳目，也不會完全準確。</p>
<p>因此從 <script type="math/tex">(5)</script> 式還有上面這個例子可以看出，真正準確的 <script type="math/tex">b</script>，來自一個<strong>非常接近 <script type="math/tex">\varepsilon</script> 的 <script type="math/tex">e</script></strong>。除了增加樣本數以外，避免分析過程中可能出現的誤差（bias）也是一個方法，這在後面的假設會提到。</p>
<h3 id="計算結果和延伸"><a href="#計算結果和延伸" class="headerlink" title="計算結果和延伸"></a>計算結果和延伸</h3><p>言歸正傳，為了根據樣本求出達成最小 <script type="math/tex">\sum _{i=1}^{n}e _{i}^{2}</script> 的 <script type="math/tex">b</script>，可以採取的方法有兩個：</p>
<ol>
<li><a href="http://stats.stackexchange.com/questions/25331/deriving-ols-estimates-using-method-of-moments" target="_blank" rel="external">Method of Moments</a>：根據 MOM 推導等式</li>
<li><a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf" target="_blank" rel="external">Derivative</a>：利用微分後的一階條件得出 b 的最大值</li>
</ol>
<p>因為計算過程有點複雜，如果都寫在這邊，可能就得轉型成 Math &amp; Note 了，所以上面兩個連結是簡略的證明過程，前面提到的兩本教科書裡也有完整說明。簡而言之，最後可以得出下式：</p>
<script type="math/tex; mode=display">
b=\left( X'X\right) ^{-1}X'Y \tag{6}</script><p>　<br>記得 <script type="math/tex">b</script> 是一個 <script type="math/tex">\left( k\times 1\right)</script> 的矩陣。另外 <script type="math/tex">(4)</script> 式中的 <script type="math/tex">\hat{Y}</script> 也可以寫成：</p>
<script type="math/tex; mode=display">
\hat{Y} = Xb =  X\left( X'X\right) ^{-1}X'Y \tag{7}</script><p>　<br>雖然這個公式看起來很複雜，但實際推導過一次以後會比較習慣；而有了標準的表達方式以後，也就能推導出 <script type="math/tex">b</script> 的各項性質，也就是在解讀參數時應該注意的細節。例如：</p>
<ol>
<li><strong>和母體的關係</strong>：<script type="math/tex; mode=display">
b=\left( X'X\right) ^{-1}X'Y=\left( X'X\right) ^{-1}X'(X\beta+\varepsilon)=\beta+\left( X'X\right) ^{-1}X'\varepsilon</script></li>
</ol>
<p>   由此可看出 <script type="math/tex">b</script> 中包含 <script type="math/tex">\varepsilon</script>，以及樣本 <script type="math/tex">X</script> 如何左右 <script type="math/tex">\varepsilon</script> 的影響程度。</p>
<ol>
<li><strong>方差分析</strong>：<script type="math/tex; mode=display">
SST = \sum _{i=1}^{n}(y _{i} - \overline {y})^{2} = SSR_{egression} + SSE_{rror} = \sum _{i=1}^{n}(\hat{y} _{i} - \overline {y})^{2} + \sum _{i=1}^{n}e _{i}^{2}</script></li>
</ol>
<p>   當 LRM 的擬合度越好， <script type="math/tex">SSE = \sum _{i=1}^{n}e_{i}^{2}</script> 越小，解釋程度 <script type="math/tex">R^{2} = \dfrac {SSR} {SST}</script> 越高。</p>
<ol>
<li><strong>期望值</strong>：<script type="math/tex; mode=display">
E\left( b|X\right)  
= \beta+\left( X'X\right) ^{-1}X'E\left(\varepsilon|X\right)
= \beta</script></li>
</ol>
<p>   隨著樣本數增加，<script type="math/tex">b</script> 將逼近 <script type="math/tex">\beta</script> 的漸進（asymptotic）和一致（consistency）性質。</p>
<ol>
<li><strong>方差（和協方差矩陣）</strong>：<script type="math/tex; mode=display">
\widehat{Var\left( b|X\right)}
= s^{2}\left( X'X\right) ^{-1}, \quad 
s^{2} = \dfrac {e'e} {n-k}</script></li>
</ol>
<p>   利用總體方差計算 <script type="math/tex">b</script> 的標準差，確認預估的精準度和有效性（efficiency）。</p>
<ol>
<li><strong>分布函數</strong>：<script type="math/tex; mode=display">
b|X\sim N\left( \beta ,s^{2}\left( X'X\right) ^{-1}\right), \quad
b_{k}|X\sim N\left( \beta ,s^{2}\left( X'X\right) ^{-1}\right) _{\left( k\times k\right) }</script></li>
</ol>
<p>   對 <script type="math/tex">b_{k}</script> 進行假設檢驗（hypothesis test）、構建信賴區間（confidence interval）等。</p>
<p>對於讀到這邊感到一頭霧水的讀者，我想說（一）不用擔心，到目前為止提到的內容，都是 <code>R</code> 等統計軟體中內建好的功能，所以就算不懂怎麼用矩陣算 <script type="math/tex">b</script> 也沒關係，分析結果中已經包含所有計算；但（二）這些內容有點類似<strong>判斷模型好壞</strong>的基礎，後面會提到這些計算、證明所衍生的性質，它們會直接影響分析過程中選擇什麼工具、如何處理資料和解讀結果。</p>
<p>以 <code>R</code> 來比喻的話，（一）的情況如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="attr">Call:</span></div><div class="line"><span class="string">lm(formula</span> <span class="string">=</span> <span class="string">mpg</span> <span class="string">~</span> <span class="string">cyl</span> <span class="string">+</span> <span class="string">disp</span> <span class="string">+</span> <span class="string">hp</span> <span class="string">+</span> <span class="string">drat</span> <span class="string">+</span> <span class="string">wt,</span> <span class="string">data</span> <span class="string">=</span> <span class="string">mtcars)</span></div><div class="line"></div><div class="line"><span class="attr">Residuals:</span></div><div class="line">    <span class="string">Min</span>      <span class="number">1</span><span class="string">Q</span>  <span class="string">Median</span>      <span class="number">3</span><span class="string">Q</span>     <span class="string">Max</span> </div><div class="line"><span class="bullet">-</span><span class="number">3.7014</span> <span class="bullet">-1.6850</span> <span class="bullet">-0.4226</span>  <span class="number">1.1681</span>  <span class="number">5.7263</span> </div><div class="line"></div><div class="line"><span class="attr">Coefficients:</span></div><div class="line">            <span class="string">Estimate</span> <span class="string">Std.</span> <span class="string">Error</span> <span class="string">t</span> <span class="string">value</span> <span class="string">Pr(&gt;|t|)</span></div><div class="line">                  <span class="comment">#1         #4      #5       #5</span></div><div class="line"><span class="string">(Intercept)</span> <span class="number">36.00836</span>    <span class="number">7.57144</span>   <span class="number">4.756</span>  <span class="number">6.4e-05</span> <span class="string">***</span></div><div class="line"><span class="string">cyl</span>         <span class="bullet">-1.10749</span>    <span class="number">0.71588</span>  <span class="bullet">-1.547</span>  <span class="number">0.13394</span>    </div><div class="line"><span class="string">disp</span>         <span class="number">0.01236</span>    <span class="number">0.01190</span>   <span class="number">1.039</span>  <span class="number">0.30845</span>    </div><div class="line"><span class="string">hp</span>          <span class="bullet">-0.02402</span>    <span class="number">0.01328</span>  <span class="bullet">-1.809</span>  <span class="number">0.08208</span> <span class="string">.</span>  </div><div class="line"><span class="string">drat</span>         <span class="number">0.95221</span>    <span class="number">1.39085</span>   <span class="number">0.685</span>  <span class="number">0.49964</span>    </div><div class="line"><span class="string">wt</span>          <span class="bullet">-3.67329</span>    <span class="number">1.05900</span>  <span class="bullet">-3.469</span>  <span class="number">0.00184</span> <span class="string">**</span> </div><div class="line"><span class="meta">---</span></div><div class="line"><span class="string">Signif.</span> <span class="attr">codes:</span>  <span class="number">0</span> <span class="string">‘***’</span> <span class="number">0.001</span> <span class="string">‘**’</span> <span class="number">0.01</span> <span class="string">‘*’</span> <span class="number">0.05</span> <span class="string">‘.’</span> <span class="number">0.1</span> <span class="string">‘</span> <span class="string">’</span> <span class="number">1</span></div><div class="line"></div><div class="line"><span class="string">Residual</span> <span class="string">standard</span> <span class="attr">error:</span> <span class="number">2.538</span> <span class="string">on</span> <span class="number">26</span> <span class="string">degrees</span> <span class="string">of</span> <span class="string">freedom</span></div><div class="line">                     <span class="comment">#2</span></div><div class="line"><span class="string">Multiple</span> <span class="attr">R-squared:</span>  <span class="number">0.8513</span><span class="string">,</span>    <span class="string">Adjusted</span> <span class="attr">R-squared:</span>  <span class="number">0.8227</span> </div><div class="line">                <span class="comment">#2                              #2 </span></div><div class="line"><span class="attr">F-statistic:</span> <span class="number">29.77</span> <span class="string">on</span> <span class="number">5</span> <span class="string">and</span> <span class="number">26</span> <span class="string">DF,</span>  <span class="attr">p-value:</span> <span class="number">5.618e-10</span> <span class="comment">#5</span></div><div class="line">         <span class="comment">#5                              #5</span></div></pre></td></tr></table></figure>
<blockquote>
<p>註：上述註記中，<code>#1</code> 為由第一個性質（和母體的關係）推導而得，以此類推。</p>
</blockquote>
<p>可以看到上述計算都已經包含在 <code>lm()</code> 的報告中，但（二）所涵蓋的問題則包括：</p>
<ul>
<li>一開始 <code>lm()</code> 中的資料選取是否妥當？</li>
<li><code>Estimate</code>、<code>Std. Error</code> 是否有偏差？如何解決？</li>
<li>如何正確解讀 <code>(Adjusted) R-squared</code>、<code>F-statistic</code> 和 <code>t value</code>？</li>
<li>分析結果是否有改進空間？如何<a href="https://en.wikipedia.org/wiki/Bias–variance_tradeoff" target="_blank" rel="external">取捨 bias 和 variance</a>？</li>
</ul>
<p>所以，這邊的分水嶺大概是「我知道怎麼操作 <code>lm()</code>、<code>glm()</code> 甚至 <code>rpart()</code> 等函數，但我不清楚這些統計結果是否正確，也不知道應該按什麼步驟處理資料、或微調（tweak）函數來改善預測結果」。Econometrics 可以幫助你瞭解背後的原理，但要學好 Econometrics，還是得從上面這些內容開始。</p>
<h2 id="假設與性質"><a href="#假設與性質" class="headerlink" title="假設與性質"></a>假設與性質</h2><p>學好上面這些基礎的重要理由之一，在於弄清楚 LRM 內部是怎麼一回事，還有這些分析是建立在哪些假設上。說到這裡，我不得不說 Dr. <del>Peanutbutter</del> Jonathan 把課程規劃得滿好。他先介紹了 LRM 的五個很重要的假設，它們分別是：</p>
<ol>
<li><strong>Linearity</strong>：<script type="math/tex">b</script> 的關係一定要是線性（<script type="math/tex">X</script> 則不在此限）</li>
<li><strong>Full Rank</strong>：<script type="math/tex">X</script> 矩陣必須為<a href="https://ccjou.wordpress.com/2012/11/12/%E7%B7%9A%E6%80%A7%E8%AE%8A%E6%8F%9B%E8%88%87%E7%9F%A9%E9%99%A3%E7%9A%84%E7%94%A8%E8%AA%9E%E6%AF%94%E8%BC%83/" target="_blank" rel="external">滿秩</a>，可以理解為不能有兩組以上完全相關的 <script type="math/tex">X</script></li>
<li><strong>Mean Independence</strong>：<script type="math/tex">E(\varepsilon|X) = 0</script>，瞭解 <script type="math/tex">X</script> 無助於瞭解 <script type="math/tex">\varepsilon</script></li>
<li><strong>Homoskedasticity &amp; Non-autocorrelation</strong>：<script type="math/tex">Var(\varepsilon|X) = \sigma^{2}</script> 和 <script type="math/tex">Cov(\varepsilon_{i}, \varepsilon_{j}|X) = 0, \forall i \neq j</script>，即 <script type="math/tex">\varepsilon</script> 的分布獨立於 <script type="math/tex">X</script>，且 <script type="math/tex">\varepsilon</script> 之間不相關</li>
<li><strong>Normality</strong>：<script type="math/tex">\varepsilon \sim N\left(0, \sigma^{2}\right)</script>，<script type="math/tex">\varepsilon</script> 的分布符合正態分布 <script type="math/tex">N</script></li>
</ol>
<blockquote>
<p>註：這邊提到的五個假設，和 <a href="https://en.wikipedia.org/wiki/Linear_regression#Assumptions" target="_blank" rel="external">Wikipedia - Linear regression</a> 與 <em>Introductory Econometrics</em> 上所提到的有些微差異，但在原理上應該是相通的，端看講者側重說明 LRM 的哪些面向。</p>
</blockquote>
<p>介紹完這五個基本假設後，我們就開始探討「如果實際資料不（完全）符合這些假設，該如何避免潛在的偏差」。於是，基於這五項假設，我們另外學了以下內容，它們的證明和推導，都是來自上面所提到的<a href="#計算結果和延伸">計算結果和延伸</a>。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">假設</th>
<th style="text-align:left">期中考前的延伸</th>
<th style="text-align:left">期末考前的延伸</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Linearity</td>
<td style="text-align:left">利用多項式（polynomial）改善 <script type="math/tex">R^{2}</script></td>
<td style="text-align:left">增設交互項（interaction term）以解讀 <script type="math/tex">X</script> 之間的交互關係</td>
</tr>
<tr>
<td style="text-align:left">Full Rank</td>
<td style="text-align:left">留意虛擬變量（dummy variable）的設定</td>
<td style="text-align:left">當 <script type="math/tex">k > n</script>時，可採取 Ridge 或 Lasso 等 Penalized Regression</td>
</tr>
<tr>
<td style="text-align:left">Mean Independence</td>
<td style="text-align:left">檢討 <script type="math/tex">b</script> 在不同樣本情況下可能出現的偏差（bias），並判斷偏差方向</td>
<td style="text-align:left">利用工具變量（instrumental variable，IV）消弭 <script type="math/tex">b</script> 偏差</td>
</tr>
<tr>
<td style="text-align:left">Homoske &amp; Non-Auto</td>
<td style="text-align:left">瞭解 OLS 估計的 <a href="https://www.allacronyms.com/MVLUE" target="_blank" rel="external"><em>MVLUE</em></a> 性質，以及影響 <script type="math/tex">Var(b_{k})</script> 的三個因素</td>
<td style="text-align:left">利用多種方法（註）修正 <script type="math/tex">\widehat{SE\left( b_{k}\right)}</script> 偏差，和用 Bootstrapping 取樣</td>
</tr>
<tr>
<td style="text-align:left">Normality</td>
<td style="text-align:left">對 <script type="math/tex">b_{k}</script> 或 <script type="math/tex">\hat{y}_{0}</script> 進行假設檢驗、計算信賴區間、<script type="math/tex">t</script> 值、<script type="math/tex">F</script> 值和 <script type="math/tex">p</script> 值</td>
<td style="text-align:left">基於 MLE 構建 <script type="math/tex">L\left(\theta\right)</script>，並用 <a href="https://en.wikipedia.org/wiki/Newton&#39;s_method" target="_blank" rel="external">Newton-Raphson</a> 等方法估計 <script type="math/tex">b</script></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>註：針對 Heteroskedasticity 的解決方案，包括 Weighted Least Squares（WLS）、Huber-White Standard Errors、Breusch-Pagan Test、 <del>DoubleJ Test</del> 和 Clustered Standard Error 等。</p>
</blockquote>
<p><img src="/2016/12/26/Advanced-Econometrics-I/seisaku.jpg" alt="穴水"></p>
<h3 id="解決潛在問題"><a href="#解決潛在問題" class="headerlink" title="解決潛在問題"></a>解決潛在問題</h3><p>讀者如果沒學過這些性質，可能會覺得一頭霧水，所以我想沿用前面的例子，說明瞭解這些性質有多重要，如果讀者有一些數據分析經驗，應該能比較好理解。</p>
<p>首先，前面我用來說明 <script type="math/tex">(3)</script> 式表達法 <script type="math/tex">Y = X\beta+\varepsilon</script> 的例子如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本編號</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（人流）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>180</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>170</td>
<td>1.5</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>200</td>
<td>1.3</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Mean-Independence"><a href="#Mean-Independence" class="headerlink" title="Mean Independence"></a>Mean Independence</h3><p>乍看之下這份資料很正常，但如果我們試著質疑它，就會引出一些潛在的問題。例如，如果我將第 <script type="math/tex">k</script> 項資料（人流）刪除：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本編號</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk-1（車流）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>40</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>50</td>
<td>2.5</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>45</td>
<td>0.3</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表格一</strong>：少了第 <script type="math/tex">k</script> 項資料（人流）</p>
<p>請問：</p>
<ul>
<li>跟原始資料相比，除了少了最後一項以外，<script type="math/tex">b</script>（即分析結果中的 <code>Estimate</code>）會出現怎樣的變化？</li>
<li>如果「人流」確實和「銷量」有關，這樣的變化是偏差還是修正？</li>
</ul>
<p>如果將和「銷量」幾乎毫不相關的「極光強度」加入模型中：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本編號</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（極光強度）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>100%</td>
<td>0.9</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>70%</td>
<td>1.7</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>15%</td>
<td>3.2</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表格二</strong>：將第 <script type="math/tex">k</script> 項資料換成「極光強度」</p>
<p>請問：</p>
<ul>
<li>跟表格一相比，除了多最後一項以外，<script type="math/tex">b</script> 會出現怎樣的變化？</li>
</ul>
<p>如果我們知道「體驗」，即顧客對消費過程中的感受，會對銷量會造成影響，但實際上「體驗」卻難以量化：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本編號</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（體驗）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>?</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>?</td>
<td>2.5</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>?</td>
<td>0.3</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表格三</strong>：將第 <script type="math/tex">k</script> 項資料換成「體驗」</p>
<blockquote>
<p>註：因「體驗」無法量化，此處殘差沿用自表格一。</p>
</blockquote>
<p>請問：</p>
<ul>
<li>少了「體驗」這項參數的 <script type="math/tex">b</script>，可能存在的偏差為何？</li>
</ul>
<p>以上三個狀況，都是在 Mean Independence 這項假設背後可能存在的問題，而且延續母體和樣本的思考，就連<strong>最初的表格</strong>也值得我們思考「<script type="math/tex">b</script> 是否存在偏差」以及「這樣的資料選取是否正確」。由於算出正確的 <code>Estimate</code> 幾乎是 LRM 基本中的基本，從性質和假設出發，培養對偏差的判斷能力非常重要。</p>
<h3 id="Homoskedasticity-amp-Non-autocorrelation"><a href="#Homoskedasticity-amp-Non-autocorrelation" class="headerlink" title="Homoskedasticity &amp; Non-autocorrelation"></a>Homoskedasticity &amp; Non-autocorrelation</h3><p>除了 Mean Independence 以外，假設四是否成立會影響分析結果中的 <code>Std. Error</code>，即 <code>Estimate</code> 的分布。由於 Homoskedasticity（<em>homo</em> 單一，<em>skedasticity</em> 方差性）假設殘差 <script type="math/tex">\varepsilon</script> 的方差（variance）不隨 <script type="math/tex">X</script> 變化，且 Non-autocorrelation 假設各 <script type="math/tex">X</script> 間的 <script type="math/tex">\varepsilon</script> 不相關，因此，理論上的方差矩陣 <script type="math/tex">Var\left( b|X\right)</script> 長得像這樣：</p>
<script type="math/tex; mode=display">
Var\left( b|X\right) = \sigma^{2}\left( X'X\right) ^{-1} =
\left[ 
\begin{matrix} Var(\beta_{1})\\ 0 \\ \vdots \\ 0 \end{matrix} 
\begin{matrix} 0 \\ Var(\beta_{2}) \\ \vdots \\ 0 \end{matrix} 
\begin{matrix} \ldots \\ \ldots \\ \ddots \\ \ldots \end{matrix} 
\begin{matrix} 0 \\ 0 \\ \vdots \\ Var(\beta_{k}) \end{matrix} 
\right]</script><p>　<br>將矩陣對角線上所有 <script type="math/tex">Var(\beta_{k})</script> 開根號，就會得到分析結果中的 <code>Std. Error</code>。然而，實際上我們預估的 <script type="math/tex">\widehat{Var\left( b|X\right)}</script> 卻可能面臨（一）方差隨 <script type="math/tex">X</script> 變化，且（二）<script type="math/tex">\varepsilon</script> 彼此相關的狀況：</p>
<script type="math/tex; mode=display">
\widehat{Var\left( b|X\right)} = \Sigma =
\left[ 
\begin{matrix} Var(b_{1})\\ Cov(\varepsilon_{1}, \varepsilon_{2}) \\ \vdots \\ Cov(\varepsilon_{1}, \varepsilon_{k}) \end{matrix} 
\begin{matrix} Cov(\varepsilon_{2}, \varepsilon_{1}) \\ Var(b_{2}) \\ \vdots \\ Cov(\varepsilon_{2}, \varepsilon_{k}) \end{matrix} 
\begin{matrix} \ldots \\ \ldots \\ \ddots \\ \ldots \end{matrix} 
\begin{matrix} Cov(\varepsilon_{k}, \varepsilon_{1}) \\ Cov(\varepsilon_{k}, \varepsilon_{2}) \\ \vdots \\ Var(b_{k}) \end{matrix} 
\right]</script><p>其中 <script type="math/tex">\Sigma</script> 無法以 <script type="math/tex">s^{2}\left( X'X\right) ^{-1}</script> 形式表達。</p>
<p>什麼情況下，分析會違反這兩個假設呢？首先是資料本身的性質。比方說在上面的原始資料裡，「銷量」和「價格」之間的關係就有可能違反 Homoskedasticity：便宜商品的銷量分布（很多到很少），和昂貴商品的銷量分布（少到很少）不同，因此分析結果中的 <code>Std. Error</code> 就可能出現偏差，後續的分析，如 <code>t value</code>、<code>Pr(&gt;|t|)</code>、<code>F-statistic</code> 等等也就不可靠。（不過倒是不會影響回 <code>Estimate</code>，因為 <script type="math/tex">b</script> 偏差與否和 Mean Independence 有關。）</p>
<p>另一種情況，則和資料的分群（cluster）有關。例如，如果原始資料和「地區」有關：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本來源</th>
<th style="text-align:left">Y（銷量）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（人流）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">台北</td>
<td style="text-align:left">20</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>180</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">台北</td>
<td style="text-align:left">23</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>170</td>
<td>1.5</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">台中</td>
<td style="text-align:left">21</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>200</td>
<td>1.3</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表格四</strong>：將「樣本編號」換成「樣本來源」</p>
<p>這時可以看出因為某些樣本來自相同地區，殘差也較有可能<a href="https://zh.wikipedia.org/zh-tw/%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0" target="_blank" rel="external">彼此相關</a>，而出現某種特徵（pattern），如果用一般的方式計算方差會得到錯誤的 <code>Std. Error</code>。對以上兩個問題的處理方法有興趣的讀者，可以參考這份 University of Maryland 的 <a href="econweb.umd.edu/~sarzosa/teach/2/Disc2_Cluster_handout.pdf"><em>Introduction to Robust and Clustered Standard Errors (PDF)</em></a>；<code>R</code> 的處理方法可以參考這篇 <a href="http://rforpublichealth.blogspot.tw/2014/10/easy-clustered-standard-errors-in-r.html" target="_blank" rel="external"><em>Easy Clustered Standard Errors in R</em></a>。</p>
<h3 id="Normality"><a href="#Normality" class="headerlink" title="Normality"></a>Normality</h3><p>最後的 Normality 雖然看起來很簡單：就算是在漸進（asymptotic，即樣本數足夠多）的情況下，只要接受這項假設，就能利用不同的分布計算信心區間等；但另一方面，一旦接受了這個假設，我們也能用之前提過的<a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1" target="_blank" rel="external">最大似然估計法</a>（MLE）估計 <script type="math/tex">b</script>。簡略的步驟如下：</p>
<ol>
<li>利用假設的分布密度函數（pdf）得出特定參數 <script type="math/tex">\theta</script>（包含 <script type="math/tex">b</script> 和 <script type="math/tex">s^{2}</script>）的機率函數： <script type="math/tex">p\left( y|X=x; \theta \right)</script></li>
<li>連乘機率函數，得 likelihood function：<script type="math/tex">L(\theta) = \prod _{i=1}^{n}p\left( y_{i}|x_{i};\theta \right)</script></li>
<li>對似然函數取自然對數（註），得 log-likelihood function：<script type="math/tex">logL(\theta) = \sum _{i=1}^{n} logp\left( y_{i}|x_{i};\theta \right)</script></li>
<li>在 <script type="math/tex">logL(\hat {\theta })</script> 最大的情況下，<script type="math/tex">\hat {\theta }</script> 即估計結果。</li>
</ol>
<blockquote>
<p>註：這個步驟的理由通常是連加 <script type="math/tex">\sum</script> 比連乘 <script type="math/tex">\prod</script> 更便於計算，詳細的說明可以參考這份 CMU 的 <a href="https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/06/lecture-06.pdf" target="_blank" rel="external"><em>The Method of Maximum Likelihood for Simple Linear Regression (PDF)</em></a>。</p>
</blockquote>
<p>最後的 <script type="math/tex">\hat {\theta }</script> 會包含 <script type="math/tex">b</script> 和 <script type="math/tex">s^{2}</script>，理論上和 OLS 所得出的結果會一樣。雖然在單一模型的情況下，用以上四個步驟代替 <code>lm()</code> 有點多此一舉，但在聯立模型（simultaneous equations models）的情況下，需要用 MLE 方法才能考慮到殘差之間的相關性。</p>
<p>一樣用前面的資料說明，不過這次除了「銷量」以外，我們還得考慮另一個「利潤」的表格：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">樣本來源</th>
<th style="text-align:left">Y（利潤）</th>
<th style="text-align:left">X1（價格）</th>
<th style="text-align:left">X2（廣告）</th>
<th>…</th>
<th>Xk（人流）</th>
<th>e（殘差）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">台北</td>
<td style="text-align:left">1.8</td>
<td style="text-align:left">15</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>180</td>
<td>1.1</td>
</tr>
<tr>
<td style="text-align:left">台北</td>
<td style="text-align:left">2.5</td>
<td style="text-align:left">14</td>
<td style="text-align:left">3</td>
<td>…</td>
<td>170</td>
<td>0.9</td>
</tr>
<tr>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td style="text-align:left">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:left">台中</td>
<td style="text-align:left">1.7</td>
<td style="text-align:left">15</td>
<td style="text-align:left">4</td>
<td>…</td>
<td>200</td>
<td>1.4</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表格五</strong>：將「銷量」換成「利潤」</p>
<p>這時，如果我們想估計「利潤」、「銷量」這兩個 <script type="math/tex">Y</script> 和 <script type="math/tex">X</script> 的關係，不能只對這兩個表格分別用 <code>lm()</code>，因為兩組殘差 <script type="math/tex">e</script> 之間的關係是不確定的；如果我們也要為兩組 <script type="math/tex">e</script> 建立一個類似 <script type="math/tex">Var\left( b|X\right)</script> 的 covariance matrix，就得用 MLE 一次估計兩組模型，這時的 <script type="math/tex">\theta</script> 會包含兩組 <script type="math/tex">b</script>、兩個 <script type="math/tex">s^{2}</script>、和一個 <script type="math/tex">e</script> 間的相關係數 <script type="math/tex">\rho</script>（註）。</p>
<blockquote>
<p>註：為了確保估計出來的 <script type="math/tex">s^{2}</script> 恆正，這邊其實要用到<a href="https://en.wikipedia.org/wiki/Cholesky_decomposition" target="_blank" rel="external">一些特殊方法</a>；一般恆正數則可以用 <script type="math/tex">e^{x}</script>。</p>
</blockquote>
<p>本質上，MLE 估計方法有點像在玩拉霸：不斷投入一組 <script type="math/tex">\theta</script>，看得出來的 <script type="math/tex">logL(\theta)</script> 多大，直到找到最大的 <script type="math/tex">logL(\hat {\theta })</script>。這也的確就是網格式參數搜尋（grid-search）的原理，不過我們也可以用一階微分、Newton-Raphson 等方法求出最大值；在 <code>R</code> 裡面，有 <code>optim()</code>、<code>nlminb()</code> 等函數可以用來求極值，不過要注意的是大部分的函數<strong>只支援求最小值</strong>，所以可能需要先將 log-likelihood function 加上負號，求 <script type="math/tex">-logL(\theta)</script> 的最小值。</p>
<p>MLE 方法裡最核心也最困難的步驟，應該是在前幾步將模型化為 likelihood function，不過，也可以說只要能寫出 likelihood function，MLE 方法可以用來預估各式各樣的模型。所以不只是一般的 LRM，<a href="http://wiki.mbalib.com/zh-tw/%E6%95%88%E7%94%A8%E5%87%BD%E6%95%B0" target="_blank" rel="external">效用函數</a>（utility function）、<a href="https://zh.wikipedia.org/zh-tw/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0" target="_blank" rel="external">強化學習</a>（reinforcement learning）等問題也能用 MLE 方法解決。比較可惜的是我們這學期幾乎沒什麼機會自己建構 likelihood function……或許得涉獵一些期刊才能見識 MLE 方法應用之廣。<del>然而為了寫這篇文章我最近是沒什麼空。</del></p>
<p><img src="/2016/12/26/Advanced-Econometrics-I/shinjuku.jpg" alt="新宿"></p>
<h2 id="延伸學習"><a href="#延伸學習" class="headerlink" title="延伸學習"></a>延伸學習</h2><p>學完這麼多東西以後，我的直接感受是用 <code>lm()</code>、<code>glm()</code> 等函數要注意的事情真多，不能像以前一樣，一看到資料，以為排個 <script type="math/tex">Y\sim X_{1}+X_{2}+\ldots+X_{k}</script>下去分析就好；解讀結果的時候，除了瞭解 causal effect，也要注意是否有偏差。當然，如果要精進分析結果，也不能只是盲目嘗試，唯有清楚原理中影響結果的因素，才有改善的空間。<del>總之就是<a href="https://www.ptt.cc/bbs/C_Chat/M.1479139001.A.DD4.html" target="_blank" rel="external">面倒くさいなあ</a>。</del></p>
<p>具體來說，我覺得學完這門課程之後可以精進的方向有三：</p>
<ol>
<li><p><strong>熟練前面的內容</strong><br>從<a href="#課前準備">課前準備</a>開始提到的矩陣運算、統計和機率，到最後的 MLE 都很重要，但老實說我學了一遍、外加參考不少資料，也不太確定自己到底掌握了幾分。考慮到 Econometrics 還是偏基礎的科目，想接觸其它分支前，還是得先把上面提到的內容學好。</p>
</li>
<li><p><strong>處理更多樣的資料</strong><br>前面舉利用的幾個表格是橫截面數據（<a href="https://en.wikipedia.org/wiki/Cross-sectional_data" target="_blank" rel="external">cross-sectional data</a>），即在特定時間點下的數據，但 Econometrics 會面對的資料型態，還包括考慮到時間變化的的時間序列（<a href="https://en.wikipedia.org/wiki/Time_series" target="_blank" rel="external">time series data</a>）和縱橫／面板數據（<a href="https://en.wikipedia.org/wiki/Panel_data" target="_blank" rel="external">panel data</a>）。<em>Introductory Econometrics</em> 的中後部分就是在講解後兩者，相信這也是我們下學期 <em>Advanced Econometrics II</em> 的重心。</p>
</li>
<li><p><strong>使用更多分析方法</strong><br>除了 <code>lm()</code> 裡包含的基本統計數據以外，依照不同的數據型態，還有不同的 bias 和 variance 取捨所衍生出的分析方法也不同；前者包括 ANOVA、時間序列分析等等，後者包括 Ridge、Lasso 等等，也和後續的降維（dimension reduction）、非線性方法有關，之前推薦過的 <a href="http://www-bcf.usc.edu/~gareth/ISL/" target="_blank" rel="external"><em>An Introduction to Statistical Learning</em></a> 裡有詳細說明這些進階方法；姊妹書 <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/" target="_blank" rel="external"><em>The Elements of Statistical Learning</em></a> 更包含背後的數理推導。</p>
</li>
</ol>
<h2 id="結語和勘誤表"><a href="#結語和勘誤表" class="headerlink" title="結語和勘誤表"></a>結語和勘誤表</h2><p>落落長的文章到此也差不多該告一個段落。雖然我剛開始寫 McK &amp; Note 的時候，從沒想過自己會寫這樣一篇充滿數學公式的文章，不過在蒐集資料的過程中，我也意識到網路上把這些假設統整起來、寫清楚的文章比較少，所以決定把自己還記得的上課內容都寫一寫，也當作是把 Econometrics 複習了一遍。希望這篇文章能為中文讀者填補一些資訊落差，也希望我的講解能讓讀者對 Econometrics 產生一些興趣，至少別把它當成艱澀、難懂的知識。</p>
<p>不過，我也清楚這篇文章是個大工程，充滿了公式和標注，即使寫完了也不敢說完全沒有錯誤，所以我在這篇文章最後預留了勘誤表。我還有一段時間要跟 Econometrics 打交道，想必偶爾還是會回來讀一讀這篇文章，如果發現有誤，會將修正記錄在這裡；如果讀者發現有任何不清楚的地方，也請不吝指正。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">日期</th>
<th style="text-align:left">位置</th>
<th style="text-align:left">修改前</th>
<th style="text-align:left">修改後</th>
<th style="text-align:left">原因</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">‘16 Dec 28</td>
<td style="text-align:left">五個表格</td>
<td style="text-align:left">ε（殘差）</td>
<td style="text-align:left">e（殘差）</td>
<td style="text-align:left">樣本估計應為 e</td>
</tr>
</tbody>
</table>
</div>
<p>　<br><em>攝影地點：JR 金沢駅、飛騨高山、穴水町、JR 新宿駅<br>感謝雪人、阿飄（飄哥）學長對本文數學公式的技術支援，與許多好友協助測試</em></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MSBA/" rel="tag"># MSBA</a>
          
            <a href="/tags/Cal-Poly/" rel="tag"># Cal Poly</a>
          
            <a href="/tags/Data-Science/" rel="tag"># Data Science</a>
          
            <a href="/tags/Econometrics/" rel="tag"># Econometrics</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/11/15/how-I-got-an-offer/" rel="next" title="＃／(How) I got an offer">
                <i class="fa fa-chevron-left"></i> ＃／(How) I got an offer
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/21/Computational-Methods/" rel="prev" title="＃／Computational Methods">
                ＃／Computational Methods <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-590ce40d557ec312" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目錄
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            本站概覽
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="Jimmy Lin" />
          <p class="site-author-name" itemprop="name">Jimmy Lin</p>
          <p class="site-description motion-element" itemprop="description">In reasoning we believe.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">93</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分類</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">159</span>
                <span class="site-state-item-name">標籤</span>
              </a>
            </div>
          

        </nav>

        <div class="links-of-author motion-element">
          
        </div>

        <div class="fb-page motion-element" data-href="https://www.facebook.com/mcknote" data-tabs="timeline" data-width="240" data-height="420" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="false">
          <div class="fb-xfbml-parse-ignore">
            <blockquote cite="https://www.facebook.com/mcknote">
              <a href="https://www.facebook.com/mcknote">McK &amp; Note</a></blockquote>
          </div>
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#秋季學期的安排"><span class="nav-number">1.</span> <span class="nav-text">秋季學期的安排</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#老師和教學方法"><span class="nav-number">2.</span> <span class="nav-text">老師和教學方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#課前準備"><span class="nav-number">3.</span> <span class="nav-text">課前準備</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#線性迴歸"><span class="nav-number">4.</span> <span class="nav-text">線性迴歸</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最小平方法"><span class="nav-number">5.</span> <span class="nav-text">最小平方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#母體和樣本"><span class="nav-number">5.1.</span> <span class="nav-text">母體和樣本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#計算結果和延伸"><span class="nav-number">5.2.</span> <span class="nav-text">計算結果和延伸</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#假設與性質"><span class="nav-number">6.</span> <span class="nav-text">假設與性質</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#解決潛在問題"><span class="nav-number">6.1.</span> <span class="nav-text">解決潛在問題</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mean-Independence"><span class="nav-number">6.2.</span> <span class="nav-text">Mean Independence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Homoskedasticity-amp-Non-autocorrelation"><span class="nav-number">6.3.</span> <span class="nav-text">Homoskedasticity & Non-autocorrelation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Normality"><span class="nav-number">6.4.</span> <span class="nav-text">Normality</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#延伸學習"><span class="nav-number">7.</span> <span class="nav-text">延伸學習</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#結語和勘誤表"><span class="nav-number">8.</span> <span class="nav-text">結語和勘誤表</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jimmy Lin</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'mcknote';
      var disqus_identifier = '2016/12/26/Advanced-Econometrics-I/';

      var disqus_title = "＃／Advanced Econometrics I";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  





  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
  


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</body>
</html>
